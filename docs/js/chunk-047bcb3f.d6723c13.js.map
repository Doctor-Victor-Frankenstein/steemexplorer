{"version":3,"sources":["webpack:///./src/views/ProposalsPage.vue?a7d8","webpack:///src/views/ProposalsPage.vue","webpack:///./src/views/ProposalsPage.vue?7494","webpack:///./src/views/ProposalsPage.vue","webpack:///./src/views/ProposalsPage.vue?933a"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","on","login","onLogin","logout","onLogout","staticClass","_v","_l","p","index","key","click","$event","selectProposal","style","backgroundImage","image","_s","creator","receiver","_e","attrs","to","url","subject","id","class","badge-primary","active","badge-warning","status","start_date","end_date","total_time","daily_pay","votes_sp","btn-primary","newVote","btn-secondary","toggleVote","icon","$store","state","auth","disabled","saving","save","reset","alert","role","infoText","domProps","innerHTML","successText","dangerText","staticRenderFns","ProposalsPagevue_type_script_lang_js_","name","data","proposals","components","HeaderEFTG","mixins","ChainProperties","SteemClient","Alerts","created","_this","getChainProperties","then","getProposals","watch","methods","_getProposals","Object","asyncToGenerator","regeneratorRuntime","mark","_callee","i","wrap","_context","prev","next","console","log","steem_database_call","sent","config","EXPLORER","permlink","parseInt","total_votes","chain","steem_per_mvests","toFixed","SP","vote","utils","textTime","Date","isActive","push","sortBy","loadVotesNoActive","logged","loadVotesFromAccount","stop","apply","arguments","type","sort","a","b","Error","concat","proposal","now","_loadVotesNoActive","_callee2","from","break_while","voters","votes","j","accounts","_context2","t0","keys","t1","done","value","abrupt","length","voter","witness_vote_weight","$set","account","total","Math","floor","parseFloat","vesting_shares","proxied_vsf_votes","_loadVotesFromAccount","_callee3","user","account_votes","proposalsNotTop","_context3","clearVotes","findIndex","activeKey","ownerKey","owner","privKey","showDanger","slice","approve_id_proposals","unapprove_id_proposals","ops","proposal_ids","approve","extensions","hideSuccess","hideDanger","hideInfo","self","steem_broadcast_sendOperations","result","showSuccess","EXPLORER2","block_num","catch","error","message","JSON","parse","stringify","views_ProposalsPagevue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_ProposalsPage_vue_vue_type_style_index_0_id_973bcd52_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_ProposalsPage_vue_vue_type_style_index_0_id_973bcd52_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default","n"],"mappings":"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","file":"js/chunk-047bcb3f.d6723c13.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('HeaderEFTG',{ref:\"headerEFTG\",on:{\"login\":_vm.onLogin,\"logout\":_vm.onLogout}}),_c('div',{staticClass:\"container\"},[_c('h2',[_vm._v(\"Proposals\")]),_c('div',{staticClass:\"card mb-2\"},[_c('ul',{staticClass:\"list-group list-group-flush\"},_vm._l((_vm.proposals),function(p,index){return _c('li',{key:index,staticClass:\"list-group-item\",on:{\"click\":function($event){return _vm.selectProposal(index)}}},[_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col-3\"},[_c('div',{staticClass:\"image-profile mr-2\",style:({ backgroundImage: 'url(' + p.image + ')' })}),_c('span',[_vm._v(_vm._s(p.creator)+\" \"),(p.creator !== p.receiver)?_c('span',[_vm._v(\"(receiver @\"+_vm._s(p.receiver)+\")\")]):_vm._e()]),_c('div',[_c('router-link',{attrs:{\"to\":p.url}},[_vm._v(_vm._s(p.subject))])],1),_c('div',[_c('small',[_vm._v(\"id #\"+_vm._s(p.id))]),_c('span',{staticClass:\"badge ml-2\",class:{'badge-primary':p.active,'badge-warning':!p.active}},[_vm._v(_vm._s(p.status))])])]),_c('div',{staticClass:\"col-4\"},[_vm._v(\"From \"+_vm._s(p.start_date)+\" to \"+_vm._s(p.end_date)+\" (\"+_vm._s(p.total_time)+\")\")]),_c('div',{staticClass:\"col-2\"},[_vm._v(_vm._s(p.daily_pay)+\" daily\")]),_c('div',{staticClass:\"col-2\"},[_vm._v(_vm._s(p.votes_sp))]),_c('div',{staticClass:\"col-1\"},[_c('button',{staticClass:\"btn\",class:{'btn-primary':p.newVote, 'btn-secondary':!p.newVote},on:{\"click\":function($event){return _vm.toggleVote(index)}}},[_c('font-awesome-icon',{attrs:{\"icon\":\"check\"}})],1)])])])}),0)]),(this.$store.state.auth.logged)?_c('div',{staticClass:\"row mt-4\"},[_c('div',{staticClass:\"form-group col-12\"},[_c('button',{staticClass:\"btn btn-primary btn-large mr-2\",attrs:{\"disabled\":_vm.saving},on:{\"click\":_vm.save}},[(_vm.saving)?_c('div',{staticClass:\"mini loader\"}):_vm._e(),_vm._v(\"Save\")]),_c('button',{staticClass:\"btn btn-secondary btn-large\",on:{\"click\":_vm.reset}},[_vm._v(\"Reset\")])])]):_vm._e(),(_vm.alert.info)?_c('div',{staticClass:\"alert alert-info\",attrs:{\"role\":\"alert\"}},[_vm._v(_vm._s(_vm.alert.infoText))]):_vm._e(),(_vm.alert.success)?_c('div',{staticClass:\"alert alert-success\",attrs:{\"role\":\"alert\"},domProps:{\"innerHTML\":_vm._s(_vm.alert.successText)}}):_vm._e(),(_vm.alert.danger)?_c('div',{staticClass:\"alert alert-danger\",attrs:{\"role\":\"alert\"}},[_vm._v(_vm._s(_vm.alert.dangerText))]):_vm._e()])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <HeaderEFTG ref=\"headerEFTG\" v-on:login=\"onLogin\" v-on:logout=\"onLogout\"></HeaderEFTG>\n    <div class=\"container\">\n      <h2>Proposals</h2>\n      <div class=\"card mb-2\">\n        <ul class=\"list-group list-group-flush\">\n          <li v-for=\"(p,index) in proposals\" :key=\"index\" class=\"list-group-item\" @click=\"selectProposal(index)\">\n            <div class=\"row\">\n              <div class=\"col-3\">\n                <div class=\"image-profile mr-2\" :style=\"{ backgroundImage: 'url(' + p.image + ')' }\"></div>\n                <span>{{p.creator}} <span v-if=\"p.creator !== p.receiver\">(receiver @{{p.receiver}})</span></span>\n                <div><router-link :to=\"p.url\">{{p.subject}}</router-link></div>\n                <div><small>id #{{p.id}}</small><span class=\"badge ml-2\" :class=\"{'badge-primary':p.active,'badge-warning':!p.active}\">{{p.status}}</span> </div>\n              </div>\n              <div class=\"col-4\">From {{p.start_date}} to {{p.end_date}} ({{p.total_time}})</div>\n              <div class=\"col-2\">{{p.daily_pay}} daily</div>\n              <div class=\"col-2\">{{p.votes_sp}}</div>\n              <div class=\"col-1\">\n                <button class=\"btn\" @click=\"toggleVote(index)\" :class=\"{'btn-primary':p.newVote, 'btn-secondary':!p.newVote}\">\n                  <font-awesome-icon icon=\"check\"/>\n                </button>\n              </div>\n            </div>\n          </li>\n        </ul>\n      </div>\n      <div v-if=\"this.$store.state.auth.logged\" class=\"row mt-4\">\n        <div class=\"form-group col-12\">\n          <button @click=\"save\" class=\"btn btn-primary btn-large mr-2\" :disabled=\"saving\"><div v-if=\"saving\" class=\"mini loader\"></div>Save</button>\n          <button @click=\"reset\" class=\"btn btn-secondary btn-large\">Reset</button>\n        </div>            \n      </div>\n      <div v-if=\"alert.info\" class=\"alert alert-info\" role=\"alert\">{{alert.infoText}}</div>\n      <div v-if=\"alert.success\" class=\"alert alert-success\" role=\"alert\" v-html=\"alert.successText\"></div>\n      <div v-if=\"alert.danger\"  class=\"alert alert-danger\" role=\"alert\">{{alert.dangerText}}</div>\n    </div>    \n  </div>\n</template>\n\n<script>\nimport HeaderEFTG from '@/components/HeaderEFTG'\nimport SteemClient from '@/mixins/SteemClient.js'\nimport Alerts from '@/mixins/Alerts.js'\nimport Utils from '@/js/utils.js'\n\nimport Config from '@/config.js'\nimport ChainProperties from '@/mixins/ChainProperties.js'\n\n\nexport default {\n  name: 'ProposalsPage',\n  \n  data() {\n    return {\n      proposals: [],\n      saving: false\n    }\n  },\n\n  components: {\n    HeaderEFTG\n  },\n\n  mixins: [\n    ChainProperties,\n    SteemClient,\n    Alerts\n  ],\n\n  created() {\n    this.getChainProperties().then( ()=>{\n      this.getProposals()\n    })\n  },\n\n  watch: {\n  },\n\n  methods: {\n    async getProposals(){\n      console.log('get')\n      this.proposals = []\n      var proposals = await this.steem_database_call('list_proposals',[['',0],100,'by_creator'])\n      for(var i in proposals){\n        var p = proposals[i]\n        p.url = Config.EXPLORER + '@' + p.creator + '/' + p.permlink\n        p.image = 'https://steemitimages.com/u/'+p.creator+'/avatar/small'\n        p.votes_sp = (parseInt(p.total_votes)/1e12 * this.chain.steem_per_mvests).toFixed(3) + ' ' + Config.SP\n        p.vote = false\n        p.newVote = false\n        p.total_time = Utils.textTime(new Date(p.end_date) - new Date(p.start_date))\n        p.active = this.isActive(p)\n        p.status = p.active ? 'active' : 'inactive'\n        this.proposals.push(p)\n      }\n      this.sortBy('votes')\n      this.loadVotesNoActive()\n      if(this.$store.state.auth.logged) this.loadVotesFromAccount()\n    },\n\n    sortBy(type){\n      switch(type){\n        case 'votes':\n          this.proposals.sort( (a,b)=>{ return parseInt(b.total_votes) - parseInt(a.total_votes) })\n          return\n        default:\n          throw new Error(`The type '${type}' for sort does not exists`)\n      }\n    },\n\n    isActive(proposal){\n      var now = Date.now()\n      return now <= new Date(proposal.end_date+'Z') && now >= new Date(proposal.start_date+'Z')\n    },\n\n    /**\n     * ISSUE: https://github.com/steemit/steem/issues/3488\n     * This call is not necessary after this issue is solved\n     */ \n    async loadVotesNoActive(){\n      for(var i in this.proposals){\n        var proposal = this.proposals[i]\n        if(this.isActive(proposal)) continue\n        proposal.total_votes = 0\n        var from = ''\n        var break_while = false\n        var voters = []\n        while(!break_while){\n          var votes = await this.steem_database_call('list_proposal_votes',[[proposal.id,from],100,'by_proposal_voter'])\n          if(votes.length > 0) console.log(`Votes: length: ${votes.length}. from '${votes[0].voter}' to '${votes[votes.length-1].voter}'`)\n\n          if(votes.length == 1){\n            break_while = true\n            if(votes[0].proposal.id == proposal.id) voters.push(votes[0].voter)\n          }else{\n            for(var j=0; j<votes.length-1; j++){ //don't take the last one. It is for the next round\n              if(votes[j].proposal.id !== proposal.id){\n                break_while = true\n                break\n              }\n              voters.push(votes[j].voter) \n            }\n          }\n          from = votes[votes.length-1].voter\n        }\n        console.log(`voters of id ${proposal.id}`)\n        console.log(voters)\n        var accounts = await this.steem_database_call('get_accounts',[voters])\n        for(var j in accounts){\n          proposal.total_votes += parseInt(this.witness_vote_weight(accounts[j]))\n        }\n        console.log(`total votes ${proposal.total_votes}`)\n        proposal.votes_sp = (parseInt(proposal.total_votes)/1e12 * this.chain.steem_per_mvests).toFixed(3) + ' ' + Config.SP\n        this.$set(this.proposals, i, proposal)\n      }\n      this.sortBy('votes')\n    },\n\n    witness_vote_weight(account) {\n      var total = Math.floor(parseFloat(account.vesting_shares)*1e6)\n      for(var i in account.proxied_vsf_votes)\n        total += parseInt(account.proxied_vsf_votes[i])\n      return total\n    },\n\n    async loadVotesFromAccount(){\n      var user = this.$store.state.auth.user\n      this.clearVotes()\n      var account_votes = await this.steem_database_call('list_proposal_votes',[[user,0],100,'by_voter_proposal'])\n      var proposalsNotTop = []\n      for(var i in account_votes){\n        var vote = account_votes[i]\n        if(vote.voter !== user) break\n        var index = this.proposals.findIndex( (p)=>{ return p.id === vote.proposal.id })\n        if(index >= 0){\n          var proposal = this.proposals[index]\n          proposal.vote = true\n          proposal.newVote = true\n          this.$set(this.proposals, index, proposal)\n        }else{\n          proposalsNotTop.push(vote)\n        }\n      }\n      if(proposalsNotTop.length > 0) {\n        console.log('TODO: these proposals are already voted but they are not in the TOP list:')\n        console.log(proposalsNotTop)\n      }\n    },\n\n    selectProposal(index){\n      var proposal = this.proposals[index]\n    },\n\n    toggleVote(index){\n      var p = this.proposals[index]\n      p.newVote = !p.newVote\n      this.$set(this.proposals, index, p)\n    },\n\n    save(){\n      var user = this.$store.state.auth.user\n      var activeKey = this.$store.state.auth.keys.active\n      var ownerKey  = this.$store.state.auth.keys.owner\n      var privKey = null\n\n      if( activeKey != null ) {\n        privKey = activeKey\n      }else if(ownerKey != null ) {\n        privKey = ownerKey \n      }else {\n        this.showDanger('Please login with master, owner, or active key')\n        return \n      }\n\n      var proposals = this.proposals.slice()\n\n      var approve_id_proposals = []\n      var unapprove_id_proposals = []\n      for(var i in proposals) {\n        var p = proposals[i]\n\n        if(p.newVote != p.vote) {\n          if(p.newVote === true) approve_id_proposals.push(p.id)\n          else unapprove_id_proposals.push(p.id)\n        }\n      }\n\n      if(approve_id_proposals.length == 0 && unapprove_id_proposals.length == 0) {\n        this.showDanger('Nothing to change')\n        return\n      }\n\n      var ops = []\n\n      if(approve_id_proposals.length > 0){\n        approve_id_proposals.sort()\n        ops.push([\n          'update_proposal_votes',\n           {\n             voter: user,\n             proposal_ids: approve_id_proposals,\n             approve: true,\n             extensions: []\n           }\n        ])\n      }\n\n      if(unapprove_id_proposals.length > 0){\n        unapprove_id_proposals.sort()\n        ops.push([\n          'update_proposal_votes',\n           {\n             voter: user,\n             proposal_ids: unapprove_id_proposals,\n             approve: false,\n             extensions: []\n           }\n        ])\n      }\n\n      this.saving = true\n      this.hideSuccess()\n      this.hideDanger()\n      this.hideInfo()\n\n      let self = this\n\n      this.steem_broadcast_sendOperations(ops,privKey)\n      .then(function(result){\n        self.saving = false\n        self.showSuccess(`<a href=\"${Config.EXPLORER2}b/${result.block_num}/${result.id}\" class=\"alert-link\" target=\"_blank\">Votes saved!</a>`)\n        self.loadVotesFromAccount()\n      })\n      .catch(function(error){\n        self.saving = false\n        self.showDanger(error.message)\n        throw error\n      })\n    },\n\n    reset(){\n      for(var i in this.proposals) {\n        var p = this.proposals[i]\n        p.newVote = JSON.parse(JSON.stringify(p.vote))\n        this.$set(this.proposals, i, p)\n      }\n      this.hideSuccess()\n      this.hideDanger()\n      this.hideInfo()\n    },\n\n    clearVotes() {\n      for(var i in this.proposals) {\n        var p = this.proposals[i]\n        p.vote = false\n        this.$set(this.proposals, i, p)\n      }      \n    },\n\n    onLogin() {\n      this.loadVotesFromAccount()\n      this.hideSuccess()\n      this.hideDanger()\n      this.hideInfo() \n    },\n    \n    onLogout() {\n      this.clearVotes()\n      this.hideSuccess()\n      this.hideDanger()\n      this.hideInfo()\n    },\n  }\n}\n</script>\n\n<style scoped>\n\n.hash {\n  font-family: monospace;\n  //font-size: 1.3rem;\n  overflow-wrap: break-word;\n}\n\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProposalsPage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProposalsPage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ProposalsPage.vue?vue&type=template&id=973bcd52&scoped=true&\"\nimport script from \"./ProposalsPage.vue?vue&type=script&lang=js&\"\nexport * from \"./ProposalsPage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ProposalsPage.vue?vue&type=style&index=0&id=973bcd52&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"973bcd52\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProposalsPage.vue?vue&type=style&index=0&id=973bcd52&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProposalsPage.vue?vue&type=style&index=0&id=973bcd52&scoped=true&lang=css&\""],"sourceRoot":""}