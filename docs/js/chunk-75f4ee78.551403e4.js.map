{"version":3,"sources":["webpack:///./src/views/ProposalsPage.vue?2955","webpack:///./src/views/ProposalsPage.vue?bfa3","webpack:///src/views/ProposalsPage.vue","webpack:///./src/views/ProposalsPage.vue?7494","webpack:///./src/views/ProposalsPage.vue?057b"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","on","onLogin","onLogout","staticClass","_v","directives","name","rawName","value","expression","$event","$$selectedVal","Array","prototype","filter","call","target","options","o","selected","map","val","_value","sort_order","multiple","attrs","_l","p","index","key","selectProposal","style","backgroundImage","image","_s","creator","receiver","_e","url","subject","id","class","active","status","start_date","end_date","total_time","daily_pay","votes_sp","newVote","toggleVote","$store","state","auth","saving","save","reset","alert","infoText","domProps","successText","dangerText","staticRenderFns","data","proposals","components","HeaderEFTG","mixins","created","getChainProperties","then","watch","methods","sortBy","sort","activeA","activeB","Error","isActive","now","Date","proposal","break_while","witness_vote_weight","total","Math","floor","parseFloat","account","vesting_shares","parseInt","proxied_vsf_votes","i","$set","user","activeKey","keys","ownerKey","privKey","showDanger","slice","approve_id_proposals","unapprove_id_proposals","ops","push","hideSuccess","hideDanger","hideInfo","steem_broadcast_sendOperations","self","showSuccess","loadVotesFromAccount","error","message","JSON","parse","stringify","vote","clearVotes","component"],"mappings":"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","file":"js/chunk-75f4ee78.551403e4.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProposalsPage.vue?vue&type=style&index=0&id=5e78292c&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProposalsPage.vue?vue&type=style&index=0&id=5e78292c&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('HeaderEFTG',{ref:\"headerEFTG\",on:{\"login\":_vm.onLogin,\"logout\":_vm.onLogout}}),_c('div',{staticClass:\"container\"},[_c('h2',[_vm._v(\"Proposals\")]),_c('div',{staticClass:\"row mb-3\"},[_c('div',{staticClass:\"col-12 text-right\"},[_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.sort_order),expression:\"sort_order\"}],on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.sort_order=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},[_c('option',{attrs:{\"value\":\"votes\"}},[_vm._v(\"Sort by votes\")]),_c('option',{attrs:{\"value\":\"start_date\"}},[_vm._v(\"Sort by start date\")]),_c('option',{attrs:{\"value\":\"end_date\"}},[_vm._v(\"Sort by end date\")]),_c('option',{attrs:{\"value\":\"total_days\"}},[_vm._v(\"Sort by total days\")]),_c('option',{attrs:{\"value\":\"id\"}},[_vm._v(\"Sort by id\")]),_c('option',{attrs:{\"value\":\"status\"}},[_vm._v(\"Sort by status\")]),_c('option',{attrs:{\"value\":\"creator\"}},[_vm._v(\"Sort by creator\")]),_c('option',{attrs:{\"value\":\"receiver\"}},[_vm._v(\"Sort by receiver\")]),_c('option',{attrs:{\"value\":\"daily_pay\"}},[_vm._v(\"Sort by daily pay\")]),_c('option',{attrs:{\"value\":\"total_pay\"}},[_vm._v(\"Sort by total pay\")])])])]),_c('div',{staticClass:\"card mb-2\"},[_c('ul',{staticClass:\"list-group list-group-flush\"},_vm._l((_vm.proposals),function(p,index){return _c('li',{key:index,staticClass:\"list-group-item\",on:{\"click\":function($event){return _vm.selectProposal(index)}}},[_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col-3\"},[_c('div',{staticClass:\"image-profile mr-2\",style:({ backgroundImage: 'url(' + p.image + ')' })}),_c('span',[_vm._v(_vm._s(p.creator)+\" \"),(p.creator !== p.receiver)?_c('span',[_vm._v(\"(receiver @\"+_vm._s(p.receiver)+\")\")]):_vm._e()]),_c('div',[_c('router-link',{attrs:{\"to\":p.url}},[_vm._v(_vm._s(p.subject))])],1),_c('div',[_c('small',[_vm._v(\"id #\"+_vm._s(p.id))]),_c('span',{staticClass:\"badge ml-2\",class:{'badge-primary':p.active,'badge-warning':!p.active}},[_vm._v(_vm._s(p.status))])])]),_c('div',{staticClass:\"col-4\"},[_vm._v(\"From \"+_vm._s(p.start_date)+\" to \"+_vm._s(p.end_date)+\" (\"+_vm._s(p.total_time)+\")\")]),_c('div',{staticClass:\"col-2\"},[_vm._v(_vm._s(p.daily_pay)+\" daily\")]),_c('div',{staticClass:\"col-2\"},[_vm._v(_vm._s(p.votes_sp))]),_c('div',{staticClass:\"col-1\"},[_c('button',{staticClass:\"btn\",class:{'btn-primary':p.newVote, 'btn-secondary':!p.newVote},on:{\"click\":function($event){return _vm.toggleVote(index)}}},[_c('font-awesome-icon',{attrs:{\"icon\":\"check\"}})],1)])])])}),0)]),(this.$store.state.auth.logged)?_c('div',{staticClass:\"row mt-4\"},[_c('div',{staticClass:\"form-group col-12\"},[_c('button',{staticClass:\"btn btn-primary btn-large mr-2\",attrs:{\"disabled\":_vm.saving},on:{\"click\":_vm.save}},[(_vm.saving)?_c('div',{staticClass:\"mini loader\"}):_vm._e(),_vm._v(\"Save\")]),_c('button',{staticClass:\"btn btn-secondary btn-large\",on:{\"click\":_vm.reset}},[_vm._v(\"Reset\")])])]):_vm._e(),(_vm.alert.info)?_c('div',{staticClass:\"alert alert-info\",attrs:{\"role\":\"alert\"}},[_vm._v(_vm._s(_vm.alert.infoText))]):_vm._e(),(_vm.alert.success)?_c('div',{staticClass:\"alert alert-success\",attrs:{\"role\":\"alert\"},domProps:{\"innerHTML\":_vm._s(_vm.alert.successText)}}):_vm._e(),(_vm.alert.danger)?_c('div',{staticClass:\"alert alert-danger\",attrs:{\"role\":\"alert\"}},[_vm._v(_vm._s(_vm.alert.dangerText))]):_vm._e()])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <HeaderEFTG ref=\"headerEFTG\" v-on:login=\"onLogin\" v-on:logout=\"onLogout\"></HeaderEFTG>\n    <div class=\"container\">\n      <h2>Proposals</h2>\n      <div class=\"row mb-3\">\n        <div class=\"col-12 text-right\">\n          <select v-model=\"sort_order\">\n            <option value=\"votes\">Sort by votes</option>\n            <option value=\"start_date\">Sort by start date</option>\n            <option value=\"end_date\">Sort by end date</option>\n            <option value=\"total_days\">Sort by total days</option>\n            <option value=\"id\">Sort by id</option>\n            <option value=\"status\">Sort by status</option>\n            <option value=\"creator\">Sort by creator</option>\n            <option value=\"receiver\">Sort by receiver</option>\n            <option value=\"daily_pay\">Sort by daily pay</option>\n            <option value=\"total_pay\">Sort by total pay</option>\n          </select>\n        </div>\n      </div>\n      <div class=\"card mb-2\">\n        <ul class=\"list-group list-group-flush\">\n          <li v-for=\"(p,index) in proposals\" :key=\"index\" class=\"list-group-item\" @click=\"selectProposal(index)\">\n            <div class=\"row\">\n              <div class=\"col-3\">\n                <div class=\"image-profile mr-2\" :style=\"{ backgroundImage: 'url(' + p.image + ')' }\"></div>\n                <span>{{p.creator}} <span v-if=\"p.creator !== p.receiver\">(receiver @{{p.receiver}})</span></span>\n                <div><router-link :to=\"p.url\">{{p.subject}}</router-link></div>\n                <div><small>id #{{p.id}}</small><span class=\"badge ml-2\" :class=\"{'badge-primary':p.active,'badge-warning':!p.active}\">{{p.status}}</span> </div>\n              </div>\n              <div class=\"col-4\">From {{p.start_date}} to {{p.end_date}} ({{p.total_time}})</div>\n              <div class=\"col-2\">{{p.daily_pay}} daily</div>\n              <div class=\"col-2\">{{p.votes_sp}}</div>\n              <div class=\"col-1\">\n                <button class=\"btn\" @click=\"toggleVote(index)\" :class=\"{'btn-primary':p.newVote, 'btn-secondary':!p.newVote}\">\n                  <font-awesome-icon icon=\"check\"/>\n                </button>\n              </div>\n            </div>\n          </li>\n        </ul>\n      </div>\n      <div v-if=\"this.$store.state.auth.logged\" class=\"row mt-4\">\n        <div class=\"form-group col-12\">\n          <button @click=\"save\" class=\"btn btn-primary btn-large mr-2\" :disabled=\"saving\"><div v-if=\"saving\" class=\"mini loader\"></div>Save</button>\n          <button @click=\"reset\" class=\"btn btn-secondary btn-large\">Reset</button>\n        </div>            \n      </div>\n      <div v-if=\"alert.info\" class=\"alert alert-info\" role=\"alert\">{{alert.infoText}}</div>\n      <div v-if=\"alert.success\" class=\"alert alert-success\" role=\"alert\" v-html=\"alert.successText\"></div>\n      <div v-if=\"alert.danger\"  class=\"alert alert-danger\" role=\"alert\">{{alert.dangerText}}</div>\n    </div>    \n  </div>\n</template>\n\n<script>\nimport HeaderEFTG from '@/components/HeaderEFTG'\nimport SteemClient from '@/mixins/SteemClient.js'\nimport Alerts from '@/mixins/Alerts.js'\nimport Utils from '@/js/utils.js'\n\nimport Config from '@/config.js'\nimport ChainProperties from '@/mixins/ChainProperties.js'\n\n\nexport default {\n  name: 'ProposalsPage',\n  \n  data() {\n    return {\n      proposals: [],\n      sort_order: 'votes',\n      saving: false\n    }\n  },\n\n  components: {\n    HeaderEFTG\n  },\n\n  mixins: [\n    ChainProperties,\n    SteemClient,\n    Alerts\n  ],\n\n  created() {\n    this.getChainProperties().then( ()=>{\n      this.getProposals()\n    })\n  },\n\n  watch: {\n    sort_order: function(new_order){ this.sortBy(new_order) },\n  },\n\n  methods: {\n    async getProposals(){\n      console.log('get')\n      this.proposals = []\n      var proposals = await this.steem_database_call('list_proposals',[['',0],100,'by_creator'])\n      for(var i in proposals){\n        var p = proposals[i]\n        p.url = Config.EXPLORER + '@' + p.creator + '/' + p.permlink\n        p.image = 'https://steemitimages.com/u/'+p.creator+'/avatar/small'\n        p.votes_sp = (parseInt(p.total_votes)/1e12 * this.chain.steem_per_mvests).toFixed(3) + ' ' + Config.SP\n        p.vote = false\n        p.newVote = false\n        p.total_time = Utils.textTime(new Date(p.end_date) - new Date(p.start_date))\n        p.active = this.isActive(p)\n        p.status = p.active ? 'active' : 'inactive'\n        this.proposals.push(p)\n      }\n      this.sortBy(this.sort_order)\n      this.loadVotesNoActive()\n      if(this.$store.state.auth.logged) this.loadVotesFromAccount()\n    },\n\n    sortBy(type){\n      switch(type){\n        case 'votes':\n          this.proposals.sort( (a,b)=>{ return parseInt(b.total_votes) - parseInt(a.total_votes) })\n          return\n        case 'start_date':\n          this.proposals.sort( (a,b)=>{ return new Date(a.start_date) - new Date(b.start_date) })\n          return\n        case 'end_date':\n          this.proposals.sort( (a,b)=>{ return new Date(a.end_date) - new Date(b.end_date) })\n          return\n        case 'total_days':\n          this.proposals.sort( (a,b)=>{ return (new Date(b.end_date) - new Date(b.start_date))\n                                              -(new Date(a.end_date) - new Date(a.start_date)) })\n          return\n        case 'creator':\n          this.proposals.sort( (a,b)=>{ return a.creator.localeCompare(b.creator) })\n          return\n        case 'receiver':\n          this.proposals.sort( (a,b)=>{ return a.receiver.localeCompare(b.receiver) })\n          return\n        case 'daily_pay':\n          this.proposals.sort( (a,b)=>{ return parseFloat(b.daily_pay) - parseFloat(a.daily_pay) })\n          return\n        case 'total_pay':\n          this.proposals.sort( (a,b)=>{ return (new Date(b.end_date) - new Date(b.start_date)) * parseFloat(b.daily_pay)\n                                              -(new Date(a.end_date) - new Date(a.start_date)) * parseFloat(a.daily_pay) })\n          return\n        case 'status':\n          this.proposals.sort( (a,b)=>{\n            var activeA = this.isActive(a)\n            var activeB = this.isActive(b)\n            if( activeA == activeB ) return parseInt(b.total_votes) - parseInt(a.total_votes) //sort by votes\n            if( activeA && !activeB ) return -1\n            if( !activeA && activeB ) return 1\n          })\n          return\n        case 'id':\n          this.proposals.sort( (a,b)=>{ return parseInt(a.id) - parseInt(b.id) })\n          return\n        default:\n          throw new Error(`The type '${type}' for sort does not exists`)\n      }\n    },\n\n    isActive(proposal){\n      var now = Date.now()\n      return now <= new Date(proposal.end_date+'Z') && now >= new Date(proposal.start_date+'Z')\n    },\n\n    /**\n     * ISSUE: https://github.com/steemit/steem/issues/3488\n     * This call is not necessary after this issue is solved\n     */ \n    async loadVotesNoActive(){\n      for(var i in this.proposals){\n        var proposal = this.proposals[i]\n        if(this.isActive(proposal)) continue\n        proposal.total_votes = 0\n        var from = ''\n        var break_while = false\n        var voters = []\n        while(!break_while){\n          var votes = await this.steem_database_call('list_proposal_votes',[[proposal.id,from],100,'by_proposal_voter'])\n          if(votes.length > 0) console.log(`Votes: length: ${votes.length}. from '${votes[0].voter}' to '${votes[votes.length-1].voter}'`)\n\n          if(votes.length == 1){\n            break_while = true\n            if(votes[0].proposal.id == proposal.id) voters.push(votes[0].voter)\n          }else{\n            for(var j=0; j<votes.length-1; j++){ //don't take the last one. It is for the next round\n              if(votes[j].proposal.id !== proposal.id){\n                break_while = true\n                break\n              }\n              voters.push(votes[j].voter) \n            }\n          }\n          from = votes[votes.length-1].voter\n        }\n        console.log(`voters of id ${proposal.id}`)\n        console.log(voters)\n        var accounts = await this.steem_database_call('get_accounts',[voters])\n        for(var j in accounts){\n          proposal.total_votes += parseInt(this.witness_vote_weight(accounts[j]))\n        }\n        console.log(`total votes ${proposal.total_votes}`)\n        proposal.votes_sp = (parseInt(proposal.total_votes)/1e12 * this.chain.steem_per_mvests).toFixed(3) + ' ' + Config.SP\n        this.$set(this.proposals, i, proposal)\n      }\n      this.sortBy(this.sort_order)\n    },\n\n    witness_vote_weight(account) {\n      var total = Math.floor(parseFloat(account.vesting_shares)*1e6)\n      for(var i in account.proxied_vsf_votes)\n        total += parseInt(account.proxied_vsf_votes[i])\n      return total\n    },\n\n    async loadVotesFromAccount(){\n      var user = this.$store.state.auth.user\n      this.clearVotes()\n      var account_votes = await this.steem_database_call('list_proposal_votes',[[user,0],100,'by_voter_proposal'])\n      var proposalsNotTop = []\n      for(var i in account_votes){\n        var vote = account_votes[i]\n        if(vote.voter !== user) break\n        var index = this.proposals.findIndex( (p)=>{ return p.id === vote.proposal.id })\n        if(index >= 0){\n          var proposal = this.proposals[index]\n          proposal.vote = true\n          proposal.newVote = true\n          this.$set(this.proposals, index, proposal)\n        }else{\n          proposalsNotTop.push(vote)\n        }\n      }\n      if(proposalsNotTop.length > 0) {\n        console.log('TODO: these proposals are already voted but they are not in the TOP list:')\n        console.log(proposalsNotTop)\n      }\n    },\n\n    selectProposal(index){\n      var proposal = this.proposals[index]\n    },\n\n    toggleVote(index){\n      var p = this.proposals[index]\n      p.newVote = !p.newVote\n      this.$set(this.proposals, index, p)\n    },\n\n    save(){\n      var user = this.$store.state.auth.user\n      var activeKey = this.$store.state.auth.keys.active\n      var ownerKey  = this.$store.state.auth.keys.owner\n      var privKey = null\n\n      if( activeKey != null ) {\n        privKey = activeKey\n      }else if(ownerKey != null ) {\n        privKey = ownerKey \n      }else {\n        this.showDanger('Please login with master, owner, or active key')\n        return \n      }\n\n      var proposals = this.proposals.slice()\n\n      var approve_id_proposals = []\n      var unapprove_id_proposals = []\n      for(var i in proposals) {\n        var p = proposals[i]\n\n        if(p.newVote != p.vote) {\n          if(p.newVote === true) approve_id_proposals.push(p.id)\n          else unapprove_id_proposals.push(p.id)\n        }\n      }\n\n      if(approve_id_proposals.length == 0 && unapprove_id_proposals.length == 0) {\n        this.showDanger('Nothing to change')\n        return\n      }\n\n      var ops = []\n\n      if(approve_id_proposals.length > 0){\n        approve_id_proposals.sort()\n        ops.push([\n          'update_proposal_votes',\n           {\n             voter: user,\n             proposal_ids: approve_id_proposals,\n             approve: true,\n             extensions: []\n           }\n        ])\n      }\n\n      if(unapprove_id_proposals.length > 0){\n        unapprove_id_proposals.sort()\n        ops.push([\n          'update_proposal_votes',\n           {\n             voter: user,\n             proposal_ids: unapprove_id_proposals,\n             approve: false,\n             extensions: []\n           }\n        ])\n      }\n\n      this.saving = true\n      this.hideSuccess()\n      this.hideDanger()\n      this.hideInfo()\n\n      let self = this\n\n      this.steem_broadcast_sendOperations(ops,privKey)\n      .then(function(result){\n        self.saving = false\n        self.showSuccess(`<a href=\"${Config.EXPLORER2}b/${result.block_num}/${result.id}\" class=\"alert-link\" target=\"_blank\">Votes saved!</a>`)\n        self.loadVotesFromAccount()\n      })\n      .catch(function(error){\n        self.saving = false\n        self.showDanger(error.message)\n        throw error\n      })\n    },\n\n    reset(){\n      for(var i in this.proposals) {\n        var p = this.proposals[i]\n        p.newVote = JSON.parse(JSON.stringify(p.vote))\n        this.$set(this.proposals, i, p)\n      }\n      this.hideSuccess()\n      this.hideDanger()\n      this.hideInfo()\n    },\n\n    clearVotes() {\n      for(var i in this.proposals) {\n        var p = this.proposals[i]\n        p.vote = false\n        this.$set(this.proposals, i, p)\n      }      \n    },\n\n    onLogin() {\n      this.loadVotesFromAccount()\n      this.hideSuccess()\n      this.hideDanger()\n      this.hideInfo() \n    },\n    \n    onLogout() {\n      this.clearVotes()\n      this.hideSuccess()\n      this.hideDanger()\n      this.hideInfo()\n    },\n  }\n}\n</script>\n\n<style scoped>\n\n.hash {\n  font-family: monospace;\n  //font-size: 1.3rem;\n  overflow-wrap: break-word;\n}\n\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProposalsPage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProposalsPage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ProposalsPage.vue?vue&type=template&id=5e78292c&scoped=true&\"\nimport script from \"./ProposalsPage.vue?vue&type=script&lang=js&\"\nexport * from \"./ProposalsPage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ProposalsPage.vue?vue&type=style&index=0&id=5e78292c&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5e78292c\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}